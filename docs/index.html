<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            scroll-behavior: smooth;
        }
        .content-section {
            min-height: 100vh;
            padding-top: 6rem; /* Adjust for fixed navbar height */
            padding-bottom: 2rem;
            position: relative; /* Needed for z-indexing */
            overflow: hidden; /* Hide canvas overflow */
        }
        /* New styles for the background canvas */
        #about-bg-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
    </style>
</head>
<body class="bg-gray-900 text-white">

    <!-- Navigation Bar -->
    <nav class="bg-gray-800/80 backdrop-blur-md fixed top-0 left-0 right-0 z-50 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <span class="font-bold text-xl text-indigo-400">MyPortfolio</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#about" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">About Me</a>
                        <a href="#gallery" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Gallery</a>
                        <a href="#github" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">GitHub</a>
                        <a href="#shaders" class="text-gray-300 hover:bg-gray-700 hover:text-white px-3 py-2 rounded-md text-sm font-medium">GLSL Shaders</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white">
                        <span class="sr-only">Open main menu</span>
                        <svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#about" class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">About Me</a>
                <a href="#gallery" class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Gallery</a>
                <a href="#github" class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">GitHub</a>
                <a href="#shaders" class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">GLSL Shaders</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <!-- About Me Section -->
        <section id="about" class="content-section flex items-center justify-center bg-gray-900">
            <!-- Background Canvas Container -->
            <div id="about-bg-canvas"></div>
            <!-- Foreground Content -->
            <div class="relative z-10 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
                <img src="https://placehold.co/150x150/4F46E5/FFFFFF?text=ME" alt="Your Name" class="w-40 h-40 rounded-full mx-auto mb-8 border-4 border-indigo-400 shadow-lg">
                <h1 class="text-4xl md:text-6xl font-bold tracking-tight text-white mb-4">Hello, I'm [Your Name]</h1>
                <p class="text-lg md:text-xl text-gray-300 max-w-2xl mx-auto">
                    I am a passionate developer and creative technologist with a love for computer graphics, interactive experiences, and beautiful design. This is my corner of the internet to showcase my work and experiments.
                </p>
            </div>
        </section>

        <!-- Gallery Section -->
        <section id="gallery" class="content-section flex items-center justify-center bg-gray-800">
            <div class="text-center">
                <h2 class="text-3xl md:text-5xl font-bold text-white mb-4">Gallery</h2>
                <p class="text-lg text-gray-400">This section is under construction. Check back soon!</p>
            </div>
        </section>

        <!-- GitHub Section -->
        <section id="github" class="content-section bg-gray-900">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-5xl font-bold text-white mb-2">My GitHub Repositories</h2>
                    <p class="text-lg text-gray-400">A live feed of my public projects on GitHub.</p>
                </div>
                <div id="repo-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <!-- GitHub repos will be dynamically inserted here -->
                </div>
            </div>
        </section>


        <!-- Shaders Section -->
        <section id="shaders" class="content-section flex flex-col items-center justify-center bg-gray-800">
            <div class="w-full max-w-5xl text-center mb-8 px-4">
                 <h2 class="text-3xl md:text-5xl font-bold text-white mb-2">GLSL Shader Showcase</h2>
                 <p class="text-lg text-gray-400">An interactive cube demonstrating a custom shader.</p>
            </div>
            <div id="shader-container" class="w-full h-[60vh] max-w-5xl rounded-lg shadow-2xl bg-black"></div>
        </section>
    </main>

    <!-- Floating Logo -->
    <img src="images/logo.png" 
         alt="Logo" 
         class="fixed bottom-8 right-8 w-[250px] h-auto opacity-75 hover:opacity-100 transition-opacity duration-300 z-40"
         onerror="this.onerror=null;this.src='https://placehold.co/250x150/1F2937/FFFFFF?text=Logo';">

    <script>
        // --- GLOBAL SETUP ---
        const clock = new THREE.Clock();

        // --- MOBILE MENU ---
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });
        document.querySelectorAll('#mobile-menu a, nav a:not(#mobile-menu-button)').forEach(link => {
            link.addEventListener('click', (e) => {
                if (!link.getAttribute('href').startsWith('#')) return;
                setTimeout(() => { mobileMenu.classList.add('hidden'); }, 150);
            });
        });

        // --- GITHUB API ---
        async function fetchGitHubRepos() {
            const repoContainer = document.getElementById('repo-container');
            const username = 'staledonuts';
            if (!repoContainer) return;
            try {
                repoContainer.innerHTML = `<p class="text-center text-gray-400 col-span-full">Loading repositories...</p>`;
                const response = await fetch(`https://api.github.com/users/${username}/repos?sort=updated&direction=desc`);
                if (!response.ok) throw new Error(`GitHub API error: ${response.status}`);
                const repos = await response.json();
                repoContainer.innerHTML = ''; 
                if (repos.length === 0) {
                    repoContainer.innerHTML = `<p class="text-center text-gray-400 col-span-full">No public repositories found for ${username}.</p>`;
                    return;
                }
                repos.forEach(repo => {
                    repoContainer.innerHTML += `
                        <a href="${repo.html_url}" target="_blank" rel="noopener noreferrer" class="block bg-gray-800 p-6 rounded-lg hover:bg-gray-700 transition duration-300 ease-in-out shadow-lg transform hover:-translate-y-1 h-full flex flex-col">
                            <h3 class="font-bold text-xl text-indigo-400 mb-2">${repo.name}</h3>
                            <p class="text-gray-400 text-sm mb-4 flex-grow">${repo.description || 'No description available.'}</p>
                            <div class="flex justify-between items-center text-sm text-gray-500 mt-auto">
                                <span>${repo.language || 'N/A'}</span>
                                <div class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>
                                    <span>${repo.stargazers_count}</span>
                                </div>
                            </div>
                        </a>`;
                });
            } catch (error) {
                repoContainer.innerHTML = `<p class="text-center text-red-400 col-span-full">${error.message}. Could not load repositories.</p>`;
                console.error("Failed to fetch GitHub repos:", error);
            }
        }

        // --- ABOUT ME INTERACTIVE BACKGROUND ---
        let aboutScene, aboutCamera, aboutRenderer, aboutMaterial;
        const aboutContainer = document.getElementById('about-bg-canvas');
        const aboutSection = document.getElementById('about');
        const mouse = new THREE.Vector2(-10, -10); // Start off-screen
        let pulseTime = -1.0;

        const aboutVertexShader = `
            void main() {
                gl_Position = vec4(position, 1.0);
            }
        `;
        const aboutFragmentShader = `
            uniform vec2 u_resolution;
            uniform vec2 u_mouse;
            uniform float u_time;
            uniform float u_pulse;

            // Simplex Noise function for a more organic look
            vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
            vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
            vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }
            float snoise(vec2 v) {
                const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);
                vec2 i  = floor(v + dot(v, C.yy) );
                vec2 x0 = v -   i + dot(i, C.xx);
                vec2 i1;
                i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
                vec4 x12 = x0.xyxy + C.xxzz;
                x12.xy -= i1;
                i = mod289(i);
                vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));
                vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
                m = m*m;
                m = m*m;
                vec3 x = 2.0 * fract(p * C.www) - 1.0;
                vec3 h = abs(x) - 0.5;
                vec3 ox = floor(x + 0.5);
                vec3 a0 = x - ox;
                m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
                vec3 g;
                g.x  = a0.x  * x0.x  + h.x  * x0.y;
                g.yz = a0.yz * x12.xz + h.yz * x12.yw;
                return 130.0 * dot(m, g);
            }


            void main() {
                vec2 st = gl_FragCoord.xy / u_resolution.xy;
                float aspect = u_resolution.x / u_resolution.y;
                st.x *= aspect;
                vec2 mouse_st = u_mouse;
                mouse_st.x *= aspect;

                float dist = distance(st, mouse_st);
                
                // --- Circle for mouse hover ---
                float circle = 1.0 - smoothstep(0.0, 0.02, dist);
                
                // --- Pulsing effect on click ---
                float pulse_val = 0.0;
                if (u_pulse > 0.0) {
                    float pulse_duration = 1.5; // seconds
                    float pulse_progress = (u_time - u_pulse) / pulse_duration;
                    if (pulse_progress < 1.0) {
                         pulse_val = smoothstep(0.0, 0.2, dist) - smoothstep(0.15, 0.3, dist);
                         pulse_val *= (1.0 - pulse_progress) * 0.7; // Fade out
                    }
                }
                
                // --- Background noise ---
                float noise = (snoise(st * 5.0 + u_time * 0.1) + 1.0) * 0.5;
                noise = pow(noise, 2.0) * 0.05;

                vec3 color = vec3(0.08, 0.09, 0.15); // Dark blue base
                color += vec3(circle * 0.5); // Additive white for the cursor circle
                color += vec3(pulse_val * 0.8, pulse_val * 0.6, pulse_val); // Additive pulse color
                color += noise;

                gl_FragColor = vec4(color, 1.0);
            }
        `;
        
        function initAboutScene() {
            if (!aboutContainer) return;
            aboutScene = new THREE.Scene();
            aboutCamera = new THREE.OrthographicCamera(-1, 1, 1, -1, 0.1, 10);
            aboutRenderer = new THREE.WebGLRenderer();
            aboutRenderer.setSize(aboutContainer.clientWidth, aboutContainer.clientHeight);
            aboutContainer.appendChild(aboutRenderer.domElement);
            
            aboutMaterial = new THREE.ShaderMaterial({
                uniforms: {
                    u_time: { value: 0.0 },
                    u_resolution: { value: new THREE.Vector2(aboutContainer.clientWidth, aboutContainer.clientHeight) },
                    u_mouse: { value: mouse },
                    u_pulse: { value: pulseTime }
                },
                vertexShader: aboutVertexShader,
                fragmentShader: aboutFragmentShader
            });

            const geometry = new THREE.PlaneGeometry(2, 2);
            const plane = new THREE.Mesh(geometry, aboutMaterial);
            aboutScene.add(plane);
            
            // Event Listeners for mouse interaction
            aboutSection.addEventListener('mousemove', (event) => {
                const rect = aboutContainer.getBoundingClientRect();
                mouse.x = (event.clientX - rect.left) / rect.width;
                mouse.y = 1.0 - (event.clientY - rect.top) / rect.height;
            });
             aboutSection.addEventListener('mouseleave', () => {
                mouse.set(-10, -10); // Move mouse off-screen
            });

            aboutSection.addEventListener('mousedown', () => {
                pulseTime = clock.getElapsedTime();
                aboutMaterial.uniforms.u_pulse.value = pulseTime;
            });

            window.addEventListener('resize', onAboutResize);
        }

        function onAboutResize() {
            if (!aboutContainer || !aboutRenderer) return;
            aboutRenderer.setSize(aboutContainer.clientWidth, aboutContainer.clientHeight);
            aboutMaterial.uniforms.u_resolution.value.set(aboutContainer.clientWidth, aboutContainer.clientHeight);
        }

        // --- SHADER CUBE SCENE ---
        let cubeScene, cubeCamera, cubeRenderer, cube;
        const cubeContainer = document.getElementById('shader-container');
        const cubeVertexShader = `varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0); }`;
        const cubeFragmentShader = `varying vec2 vUv; uniform float u_time; void main() { gl_FragColor = vec4(0.5 + 0.5 * cos(u_time + vUv.x * 5.0), 0.5 + 0.5 * sin(u_time + vUv.y * 5.0), 0.8, 1.0); }`;

        function initCubeScene() {
            if (!cubeContainer) return;
            cubeScene = new THREE.Scene();
            cubeCamera = new THREE.PerspectiveCamera(75, cubeContainer.clientWidth / cubeContainer.clientHeight, 0.1, 1000);
            cubeCamera.position.z = 2;
            cubeRenderer = new THREE.WebGLRenderer({ antialias: true });
            cubeRenderer.setSize(cubeContainer.clientWidth, cubeContainer.clientHeight);
            cubeRenderer.setPixelRatio(window.devicePixelRatio);
            cubeContainer.appendChild(cubeRenderer.domElement);
            const geometry = new THREE.BoxGeometry(1, 1, 1);
            const material = new THREE.ShaderMaterial({
                uniforms: { u_time: { value: 0.0 } },
                vertexShader: cubeVertexShader,
                fragmentShader: cubeFragmentShader
            });
            cube = new THREE.Mesh(geometry, material);
            cubeScene.add(cube);
            window.addEventListener('resize', onCubeResize, false);
        }
        function onCubeResize() {
            if (!cubeContainer || !cubeRenderer || !cubeCamera) return;
            cubeCamera.aspect = cubeContainer.clientWidth / cubeContainer.clientHeight;
            cubeCamera.updateProjectionMatrix();
            cubeRenderer.setSize(cubeContainer.clientWidth, cubeContainer.clientHeight);
        }

        // --- MAIN ANIMATION LOOP ---
        function animate() {
            requestAnimationFrame(animate);
            const elapsedTime = clock.getElapsedTime();

            // Animate About Scene
            if (aboutRenderer) {
                aboutMaterial.uniforms.u_time.value = elapsedTime;
                aboutRenderer.render(aboutScene, aboutCamera);
            }
            // Animate Cube Scene
            if (cubeRenderer) {
                cube.material.uniforms.u_time.value = elapsedTime;
                cube.rotation.x += 0.005;
                cube.rotation.y += 0.005;
                cubeRenderer.render(cubeScene, cubeCamera);
            }
        }

        // --- INITIALIZATION ---
        window.onload = function() {
            initAboutScene();
            initCubeScene();
            fetchGitHubRepos();
            animate(); // Start the single animation loop
        }
    </script>
</body>
</html>
